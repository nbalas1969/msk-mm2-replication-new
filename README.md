# MSK MirrorMaker 2 Terraform Project

This repository provisions a scalable, production-grade AWS infrastructure for cross-region Kafka topic replication using **Amazon MSK**, **MSK Connect**, and **Apache MirrorMaker 2 (MM2)**. Built entirely with Terraform and driven by modular IaC principles.

---

## ğŸ“¦ Features

- âš™ï¸ Modular infrastructure using `msk-connect`, `vpc-peering`, and `notifications`
- ğŸŒ Multi-region VPC peering with automatic CIDR route configuration
- ğŸ” MirrorMaker 2 replication with custom plugin support
- ğŸš¨ Post-deploy notifications to Microsoft Teams, SNS Email, or AWS SSM
- ğŸ“œ Configurable via `.tfvars`, reusable in CI/CD
- ğŸ” Validation helpers for offset monitoring and connector health

---

## ğŸ—‚ï¸ Project Structure
â”œâ”€â”€ main.tf                     # Root module: wires everything â”œâ”€â”€ variables.tf                # Root input declarations â”œâ”€â”€ outputs.tf                  # Root outputs from submodules â”œâ”€â”€ terraform.tfvars            # Private input values (gitignored) â”œâ”€â”€ modules/ â”‚   â”œâ”€â”€ msk-connect/            # Defines MSK Connect connector â”‚   â”œâ”€â”€ vpc-peering/            # Creates and routes VPC peering connection â”‚   â””â”€â”€ notifications/          # Sends messages to Teams, SNS, and/or SSM â”œâ”€â”€ mm2-config/                 # Contains mm2.properties and JSON configs â”œâ”€â”€ scripts/ â”‚   â”œâ”€â”€ validate-mm2-replication.sh  # Validate connector + mirrored topics â”‚   â””â”€â”€ get-vpc-peering-inputs.sh    # AWS helper script (generates tfvars)


---

## ğŸš€ Quick Start

```bash
terraform init
terraform plan -var-file="terraform.tfvars"
terraform apply

ğŸ”” Optional Notifications
Enable Microsoft Teams notifications by setting the following in your terraform.tfvars:
enable_notifications       = true
enable_teams_notification  = true
teams_webhook_url          = "https://<your-teams-webhook>"
test_notification_mode     = false


For SSM and email SNS delivery, refer to modules/notifications.

ğŸ§ª Validate Post-Deployment
bash scripts/validate-mm2-replication.sh


Checks include:
- MSK Connect connector status
- Mirrored topics in destination cluster
- (Optional) Add consumer lag checks

ğŸ“„ Generated by
- Copilot + Balasubramanyam
- July 2025 Â· Hyderabad, India ğŸ‡®ğŸ‡³

---

### âœ… Commit and Push It

From your project root, run:

```bash
git add README.md
git commit -m "Add project README"
git push origin main --force

